# AI Town éƒ¨ç½²è…³æœ¬èªªæ˜

## ğŸ“ è…³æœ¬æ¸…å–®

### è‡ªå‹•åŒ–éƒ¨ç½²è…³æœ¬

- **0-deploy-all.bat** - ä¸€éµéƒ¨ç½²ï¼ˆæ¨è–¦æ–°æ‰‹ä½¿ç”¨ï¼‰
  - è‡ªå‹•åŸ·è¡Œæ‰€æœ‰éƒ¨ç½²æ­¥é©Ÿ
  - é è¨ˆéœ€è¦ 5-10 åˆ†é˜

### åˆ†æ­¥é©Ÿéƒ¨ç½²è…³æœ¬

1. **1-import-image.bat** - åŒ¯å…¥ Docker æ˜ åƒ
   - å¾ tar.gz æˆ– tar æª”æ¡ˆåŒ¯å…¥æ˜ åƒ
   - è‡ªå‹•é©—è­‰ SHA256 æ ¡é©—ç¢¼
   - æª¢æŸ¥ä¸¦è™•ç†ç¾æœ‰æ˜ åƒ

2. **2-setup-environment.bat** - ç’°å¢ƒè¨­ç½®
   - æª¢æŸ¥å¿…è¦æª”æ¡ˆ
   - å‰µå»º .env.local
   - é©—è­‰ç«¯å£å¯ç”¨æ€§

3. **3-start-container.bat** - å•Ÿå‹•å®¹å™¨
   - å•Ÿå‹• Docker å®¹å™¨
   - æª¢æŸ¥æœå‹™å¯è¨ªå•æ€§
   - é¡¯ç¤ºå¥åº·ç‹€æ…‹

4. **4-init-database.bat** - åˆå§‹åŒ–è³‡æ–™åº«
   - åŒæ­¥ Convex å‡½å¼
   - åŸ·è¡Œè³‡æ–™åº«åˆå§‹åŒ–
   - è‡ªå‹•ç²å– ADMIN_KEY

### ç®¡ç†è…³æœ¬

- **stop-container.bat** - åœæ­¢å®¹å™¨

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³• 1: ä¸€éµéƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰

```batch
0-deploy-all.bat
```

### æ–¹æ³• 2: åˆ†æ­¥é©Ÿéƒ¨ç½²

```batch
1-import-image.bat
2-setup-environment.bat
3-start-container.bat
4-init-database.bat
```

---

## ğŸ“‹ å‰ç½®éœ€æ±‚

### å¿…é ˆå®‰è£
- [Docker Desktop](https://www.docker.com/products/docker-desktop)
- [Node.js 18+](https://nodejs.org/)

### å¿…é ˆæº–å‚™
- `ai-town-image-latest.tar.gz` (æˆ– .tar)
- `docker-compose.yml`
- `docker-entrypoint.sh`
- `data/` ç›®éŒ„
- `convex/` ç›®éŒ„

---

## ğŸ“‚ æª”æ¡ˆçµæ§‹

```
éƒ¨ç½²ç›®éŒ„/
â”œâ”€â”€ deploy-scripts/          # éƒ¨ç½²è…³æœ¬ç›®éŒ„
â”‚   â”œâ”€â”€ 0-deploy-all.bat
â”‚   â”œâ”€â”€ 1-import-image.bat
â”‚   â”œâ”€â”€ 2-setup-environment.bat
â”‚   â”œâ”€â”€ 3-start-container.bat
â”‚   â”œâ”€â”€ 4-init-database.bat
â”‚   â”œâ”€â”€ stop-container.bat
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ ai-town-image-latest.tar.gz
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docker-entrypoint.sh
â”œâ”€â”€ .env.local (è‡ªå‹•ç”Ÿæˆ)
â”œâ”€â”€ data/
â””â”€â”€ convex/
```

---

## âš™ï¸ è…³æœ¬åŠŸèƒ½è©³è§£

### 1-import-image.bat

**åŠŸèƒ½**:
- æª¢æŸ¥ Docker å®‰è£
- å°‹æ‰¾æ˜ åƒæª”æ¡ˆï¼ˆå„ªå…ˆ .tar.gzï¼‰
- é©—è­‰ SHA256 æ ¡é©—ç¢¼
- è™•ç†ç¾æœ‰æ˜ åƒè¡çª
- åŒ¯å…¥æ˜ åƒåˆ° Docker

**éŒ¯èª¤è™•ç†**:
- æœªå®‰è£ Docker â†’ æç¤ºå®‰è£
- æ‰¾ä¸åˆ°æ˜ åƒæª”æ¡ˆ â†’ åˆ—å‡ºé æœŸæª”å
- æ ¡é©—ç¢¼ä¸åŒ¹é… â†’ è©¢å•æ˜¯å¦ç¹¼çºŒ
- å·²å­˜åœ¨æ˜ åƒ â†’ è©¢å•æ˜¯å¦è¦†è“‹

### 2-setup-environment.bat

**åŠŸèƒ½**:
- æª¢æŸ¥å¿…è¦æª”æ¡ˆ
- å‰µå»º .env.localï¼ˆå¦‚ä¸å­˜åœ¨ï¼‰
- é©—è­‰ Node.js å®‰è£
- æª¢æŸ¥ Docker Compose
- æª¢æŸ¥ç«¯å£å ç”¨ï¼ˆ5173, 3210ï¼‰

**éŒ¯èª¤è™•ç†**:
- ç¼ºå°‘æª”æ¡ˆ â†’ åˆ—å‡ºç¼ºå°‘çš„æª”æ¡ˆ
- æœªå®‰è£ Node.js â†’ æç¤ºå®‰è£ï¼ˆè­¦å‘Šï¼‰
- ç«¯å£å ç”¨ â†’ é¡¯ç¤ºè­¦å‘Š

### 3-start-container.bat

**åŠŸèƒ½**:
- æª¢æŸ¥ Docker æœå‹™ç‹€æ…‹
- é©—è­‰æ˜ åƒå­˜åœ¨
- è™•ç†ç¾æœ‰å®¹å™¨
- å•Ÿå‹•å®¹å™¨
- ç­‰å¾…å®¹å™¨å°±ç·’ï¼ˆ30ç§’ï¼‰
- æª¢æŸ¥æœå‹™å¯è¨ªå•æ€§
- é¡¯ç¤ºå¥åº·ç‹€æ…‹

**éŒ¯èª¤è™•ç†**:
- Docker æœªé‹è¡Œ â†’ æç¤ºå•Ÿå‹• Docker Desktop
- æ˜ åƒä¸å­˜åœ¨ â†’ æç¤ºåŸ·è¡Œæ­¥é©Ÿ 1
- å·²æœ‰é‹è¡Œå®¹å™¨ â†’ è©¢å•æ˜¯å¦é‡å•Ÿ
- å•Ÿå‹•å¤±æ•— â†’ æä¾›æ•…éšœæ’é™¤å»ºè­°

### 4-init-database.bat

**åŠŸèƒ½**:
- é©—è­‰ Node.js
- æª¢æŸ¥å®¹å™¨é‹è¡Œç‹€æ…‹
- æ¸¬è©¦ Convex å¾Œç«¯é€£æ¥
- å¾ docker-entrypoint.sh ç²å– ADMIN_KEY
- åŒæ­¥ Convex å‡½å¼
- åŸ·è¡Œè³‡æ–™åº«åˆå§‹åŒ–

**éŒ¯èª¤è™•ç†**:
- æœªå®‰è£ Node.js â†’ æç¤ºå®‰è£
- å®¹å™¨æœªé‹è¡Œ â†’ æç¤ºåŸ·è¡Œæ­¥é©Ÿ 3
- ç„¡æ³•é€£æ¥å¾Œç«¯ â†’ æä¾›æ•…éšœæ’é™¤å»ºè­°
- ç„¡æ³•ç²å– ADMIN_KEY â†’ æä¾›æ‰‹å‹•å‘½ä»¤
- åˆå§‹åŒ–å¤±æ•— â†’ æç¤ºé‡è©¦æˆ–æ‰‹å‹•åŸ·è¡Œ

---

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1: "æ‰¾ä¸åˆ° Docker"

**è§£æ±ºæ–¹æ³•**:
1. å®‰è£ Docker Desktop
2. ç¢ºä¿ Docker Desktop å·²å•Ÿå‹•
3. é‡æ–°åŸ·è¡Œè…³æœ¬

### å•é¡Œ 2: "ç«¯å£å·²è¢«å ç”¨"

**è§£æ±ºæ–¹æ³•**:
```batch
# æŸ¥çœ‹å ç”¨é€²ç¨‹
netstat -ano | findstr ":5173"
netstat -ano | findstr ":3210"

# çµæŸå ç”¨é€²ç¨‹ï¼ˆæ›¿æ› PIDï¼‰
taskkill /PID <PID> /F
```

### å•é¡Œ 3: "å®¹å™¨å•Ÿå‹•å¤±æ•—"

**è§£æ±ºæ–¹æ³•**:
```batch
# æŸ¥çœ‹è©³ç´°æ—¥èªŒ
docker logs ai-town-production

# æª¢æŸ¥ docker-compose.yml
docker-compose config

# æ¸…ç†ä¸¦é‡è©¦
docker-compose down
docker system prune -f
```

### å•é¡Œ 4: "è³‡æ–™åº«åˆå§‹åŒ–è¶…æ™‚"

**è§£æ±ºæ–¹æ³•**:
- é‡æ–°åŸ·è¡Œ `4-init-database.bat`
- Init æœ¬èº«åªéœ€ 2-5 ç§’ï¼Œè¶…æ™‚é€šå¸¸æ˜¯ç¶²è·¯å•é¡Œ
- æª¢æŸ¥é˜²ç«ç‰†è¨­ç½®

---

## ğŸ“Š éƒ¨ç½²æµç¨‹åœ–

```
é–‹å§‹
  â”‚
  â”œâ”€â–º [æª¢æŸ¥ Docker] â”€â–º æœªå®‰è£ â”€â–º æç¤ºå®‰è£ â”€â–º çµæŸ
  â”‚        â”‚
  â”‚       å·²å®‰è£
  â”‚        â”‚
  â”œâ”€â–º [åŒ¯å…¥æ˜ åƒ] â”€â–º å¤±æ•— â”€â–º é¡¯ç¤ºéŒ¯èª¤ â”€â–º çµæŸ
  â”‚        â”‚
  â”‚       æˆåŠŸ
  â”‚        â”‚
  â”œâ”€â–º [è¨­ç½®ç’°å¢ƒ] â”€â–º ç¼ºå°‘æª”æ¡ˆ â”€â–º æç¤ºè¤‡è£½ â”€â–º çµæŸ
  â”‚        â”‚
  â”‚       å°±ç·’
  â”‚        â”‚
  â”œâ”€â–º [å•Ÿå‹•å®¹å™¨] â”€â–º å¤±æ•— â”€â–º æ•…éšœæ’é™¤ â”€â–º çµæŸ
  â”‚        â”‚
  â”‚       æˆåŠŸ
  â”‚        â”‚
  â”œâ”€â–º [åˆå§‹åŒ–è³‡æ–™åº«] â”€â–º å¤±æ•— â”€â–º é‡è©¦/æ‰‹å‹• â”€â–º çµæŸ
  â”‚        â”‚
  â”‚       æˆåŠŸ
  â”‚        â”‚
  â””â”€â–º [éƒ¨ç½²å®Œæˆ] â”€â–º è¨ªå•æ‡‰ç”¨
```

---

## ğŸ¯ æœ€ä½³å¯¦è¸

### é¦–æ¬¡éƒ¨ç½²
1. ä½¿ç”¨ `0-deploy-all.bat` ä¸€éµéƒ¨ç½²
2. ç­‰å¾…æ‰€æœ‰æ­¥é©Ÿå®Œæˆ
3. è¨ªå• http://localhost:5173/ é©—è­‰

### æ—¥å¸¸ä½¿ç”¨
```batch
# å•Ÿå‹•æœå‹™
docker-compose up -d

# åœæ­¢æœå‹™
docker-compose down

# æŸ¥çœ‹æ—¥èªŒ
docker logs ai-town-production

# é‡å•Ÿæœå‹™
docker-compose restart
```

### é‡æ–°éƒ¨ç½²
```batch
# æ¸…ç†ç¾æœ‰ç’°å¢ƒ
docker-compose down
docker volume rm ai-town_ai-town-database

# é‡æ–°åŸ·è¡Œéƒ¨ç½²
0-deploy-all.bat
```

---

## ğŸ“ ç’°å¢ƒè®Šæ•¸èªªæ˜

`.env.local` æª”æ¡ˆå…§å®¹:

```bash
# Convex æœ¬åœ°å¾Œç«¯ URL
VITE_CONVEX_URL=http://127.0.0.1:3210

# Ollama LLM API URL (å¯é¸)
# å¦‚æœéœ€è¦ä½¿ç”¨æœ¬åœ° LLMï¼Œå–æ¶ˆè¨»è§£ä¸¦ç¢ºä¿ Ollama é‹è¡Œ
# LLM_API_URL=http://host.docker.internal:11434
```

---

## ğŸ”— ç›¸é—œæ–‡ä»¶

- [è©³ç´°åŒ¯å…¥æŒ‡å—](../DOCKER_IMAGE_IMPORT_GUIDE.md)
- [Convex åˆå§‹åŒ–æŒ‡å—](../docs/setup/CONVEX_INIT_GUIDE.md)
- [å¿«é€Ÿåƒè€ƒ](../DOCKER_IMPORT_QUICKSTART.txt)

---

**æœ€å¾Œæ›´æ–°**: 2025-11-12
**è…³æœ¬ç‰ˆæœ¬**: 1.0
**æ”¯æ´å¹³å°**: Windows 10/11
